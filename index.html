<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="Raid Seed Finder">
    <meta property="og:description" content="Filter raid seeds by species, shiny status, and tera type in Pokémon Scarlet.">
    <meta property="og:image" content="https://kevdog-png.github.io/RaidSeedFinder/thumbnail.png">
    <meta property="og:url" content="https://kevdog-png.github.io/RaidSeedFinder/">
    <meta property="og:type" content="website">
    <title>Raid Seed Filter</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>
<body>
    <div id="discord-bar">
        <a href="https://discord.gg/plza" target="_blank">Join our Discord server!</a>
    </div>

    <h1>Raid Seed Filter</h1>
    <form id="filterForm">
        <label for="species">Species:</label>
        <input type="text" id="species" name="species" placeholder="e.g., Goodra"><br><br>

        <label for="shiny">Shiny:</label>
        <select id="shiny" name="shiny">
            <option value="">Any</option>
            <option value="Yes">Yes</option>
            <option value="No">No</option>
        </select><br><br>

        <label for="tera_type">Tera Type:</label>
        <select id="tera_type" name="tera_type">
            <option value="">Any</option>
            <option value="Normal">Normal</option>
            <option value="Fire">Fire</option>
            <option value="Water">Water</option>
            <option value="Electric">Electric</option>
            <option value="Grass">Grass</option>
            <option value="Ice">Ice</option>
            <option value="Fighting">Fighting</option>
            <option value="Poison">Poison</option>
            <option value="Ground">Ground</option>
            <option value="Flying">Flying</option>
            <option value="Psychic">Psychic</option>
            <option value="Bug">Bug</option>
            <option value="Rock">Rock</option>
            <option value="Ghost">Ghost</option>
            <option value="Dragon">Dragon</option>
            <option value="Dark">Dark</option>
            <option value="Steel">Steel</option>
            <option value="Fairy">Fairy</option>
            <option value="Stellar">Stellar</option>
        </select><br><br>

        <button type="submit">Filter</button>
    </form>

    <h2>Results:</h2>
    <ul id="results"></ul>

    <div id="footer">
        Special thanks to MewTracker for the raid seeds!
    </div>

    <script>
        // Function to handle form submission
        document.getElementById('filterForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent form submission

            const species = document.getElementById('species').value.toLowerCase();
            const shiny = document.getElementById('shiny').value;
            const teraType = document.getElementById('tera_type').value.toLowerCase();

            // Fetch data from the JSON file
            fetch('scarlet6iv5star.json')
                .then(response => response.json())
                .then(data => {
                    const filteredSeeds = data.seeds.filter(seed => {
                        return (
                            (species === '' || seed.species.toLowerCase().includes(species)) &&
                            (shiny === '' || seed.shiny === shiny) &&
                            (teraType === '' || seed.tera_type.toLowerCase().includes(teraType))
                        );
                    });

                    displayResults(filteredSeeds);
                })
                .catch(error => console.error('Error fetching seed data:', error));
        });

        // Function to display the filtered seeds in the UI
        function displayResults(seeds) {
            const resultsContainer = document.getElementById('results');
            resultsContainer.innerHTML = ''; // Clear previous results

            if (seeds.length === 0) {
                resultsContainer.innerHTML = '<li>No matching results found.</li>';
                return;
            }

            seeds.forEach(seed => {
                const seedDiv = document.createElement('li');
                seedDiv.classList.add('seed');

                // Add Pokémon sprite URL (using the species name to format the image URL)
                const pokemonImageUrl = `https://raw.githubusercontent.com/remokon/gen-9-sprites/main/sprites/pokemon/${seed.species.toLowerCase().replace(/\s+/g, '')}.png`;

                // Aggregate item rewards
                const itemCounts = seed.rewards.reduce((acc, reward) => {
                    const rewardKey = reward.name;
                    if (acc[rewardKey]) {
                        acc[rewardKey] += reward.count;
                    } else {
                        acc[rewardKey] = reward.count;
                    }
                    return acc;
                }, {});

                const itemList = Object.keys(itemCounts).map(item => 
                    `<li>${itemCounts[item]} x ${item}</li>`
                ).join('');

                seedDiv.innerHTML = `
                    <strong>Species:</strong> ${seed.species} <br>
                    <strong>Tera Type:</strong> ${seed.tera_type} <br>
                    <strong>Shiny:</strong> ${seed.shiny} <br>
                    <strong>Seed:</strong> ${seed.seed} <br>
                    <strong>Item Drops:</strong>
                    <ul>
                        ${itemList}
                    </ul>
                    <img class="pokemon-image" src="${pokemonImageUrl}" alt="${seed.species} sprite">
                `;
                resultsContainer.appendChild(seedDiv);
            });
        }
    </script>
</body>
</html>
